library(phytools)
library(TreeSim)
set.seed(1234)
tree <- TreeSim::sim.bd.taxa(10, 1)
tree <- TreeSim::sim.bd.taxa(10, 1, lambda = 0.01)
tree <- TreeSim::sim.bd.taxa(10, 1, lambda = 0.01, mu = 0.005)
plot(tree)
library(TreeSim)
plot(tree)
library(ape)
plot(tree)
tree
plot(tree[[1]])
?TreeSim::sim.bd.taxa
tree <- TreeSim::sim.bd.taxa(10, 1, lambda = 0.01, mu = 0.005, complete = TRUE)
tree
plot(tree[[1]])
plot(tree[[1]], show.tip.label = FALSE)
plot(tree[[1]], show.tip.label = FALSE, type = "fan")
dr <- picante:evol.distinct(tree[[1]], type = "equal.splits",
scale = FALSE, use.branch.lengths = TRUE)
dr <- picante::evol.distinct(tree[[1]], type = "equal.splits",
scale = FALSE, use.branch.lengths = TRUE)
dr
eq <- picante::evol.distinct(tree[[1]], type = "equal.splits",
scale = FALSE, use.branch.lengths = TRUE)
dr <- 1/eq$w
dr
anc <- phytools::fastAnc(tree[[1]], dr)
anc
plot(tree[[1]], edge.color = heat.colors(anc))
ape::plot(tree[[1]], edge.color = heat.colors(anc))
ape::plot.phylo(tree[[1]], edge.color = heat.colors(anc))
heat.colors(anc)
heat.colors(10)
heat.colors(nrow(anc))
anc
heat.colors(length(anc))
colors <- colors[order(anc)]
order(anc)
colors[order(anc)]
colors
heat.colors(length(anc))
colors <- heat.colors(length(anc))
colors
colors <- colors[order(anc)]
colors
library(ape)
plot(tree[[1]], edge.colors = colors)
plot(tree[[1]], edge.color = colors)
anc
anc <- c(dr, anc)
colors <- heat.colors(length(anc))
colors <- colors[order(anc)]
plot(tree[[1]], edge.color = colors)
plot(tree[[1]])
anc
dr
eq
names(dr) <- eq$Species
anc <- phytools::fastAnc(tree[[1]], dr)
anc <- c(dr, anc)
anc
colors <- heat.colors(length(anc))
order(anc)
colors <- colors[order(anc)]
tree$edge
tree[[1]]$edge
tree[[1]]$tip.label
tree[[1]]$edge %in% 1:length(tree[[1]]$tip.label)
tree[[1]]$edge[, 2] %in% 1:length(tree[[1]]$tip.label)
which(tree[[1]]$edge[, 2] %in% 1:length(tree[[1]]$tip.label))
anc
which(tree[[1]]$tip.label == eq$Species)
tree[[1]]$tip.label
names(dr) <- 1:length(tree[[1]]$tip.label)
dr
names(dr) <- 1:length(tree[[1]]$tip.label)
anc <- phytools::fastAnc(tree[[1]], dr)
names(dr) <- eq$Species
anc <- phytools::fastAnc(tree[[1]], dr)
anc
anc <- c(dr, anc)
anc
names[anc][1:length(tree[[1]]$tip.label)]
1:length(tree[[1]]$tip.label)
names(anc)[1:length(tree[[1]]$tip.label)]
names(anc)[1:length(tree[[1]]$tip.label)] <- 1:length(tree[[1]]$tip.label)
colors <- heat.colors(length(anc))
tree[[1]]$edge
tree[[1]]$edge[, 2] %in% 1:length(tree[[1]]$tip.label)
anc
anc
dr <- 1/eq$w
names(dr) <- eq$Species
anc <- phytools::fastAnc(tree[[1]], dr)
anc
length(tree[[1]]$tip.label)
names(anc)
tree[[1]]$Nnode
anc
(length(tree[[1]]$tip.label) + 1):(length(tree[[1]]$tip.label) + tree[[1]]$Nnode)
tree[[1]]$edge[, 2] %in% 1:length(tree[[1]]$tip.label),
tree[[1]]$edge[, 1] %in% (length(tree[[1]]$tip.label) + 1):(length(tree[[1]]$tip.label) + tree[[1]]$Nnode)
tree[[1]]$edge[, 2] %in% 1:length(tree[[1]]$tip.label),
tree[[1]]$edge[, 1] %in% (length(tree[[1]]$tip.label) + 1):(length(tree[[1]]$tip.label) + tree[[1]]$Nnode)
tree[[1]]$edge[, 1] %in% (length(tree[[1]]$tip.label) + 1):(length(tree[[1]]$tip.label) + tree[[1]]$Nnode)
which(tree[[1]]$edge[, 1] %in% (length(tree[[1]]$tip.label) + 1):(length(tree[[1]]$tip.label) + tree[[1]]$Nnode))
which(tree[[1]]$edge[, 2] %in% 1:length(tree[[1]]$tip.label))
(length(tree[[1]]$tip.label) + 1):(length(tree[[1]]$tip.label) + tree[[1]]$Nnode)
tree[[1]]$edge[, 1]
tree[[1]]$edge
which(tree[[1]]$edge[, 2] %in% (length(tree[[1]]$tip.label) + 1):(length(tree[[1]]$tip.label) + tree[[1]]$Nnode))
tree[[1]]$edge
which(tree[[1]]$edge[, 2] %in% 1:length(tree[[1]]$tip.label)
which(tree[[1]]$edge[, 2] %in% 1:length(tree[[1]]$tip.label))
which(tree[[1]]$edge[, 2] == 1:length(tree[[1]]$tip.label))
match(tree[[1]]$edge[, 2], 1:length(tree[[1]]$tip.label))
match(1:length(tree[[1]]$tip.label)), tree[[1]]$edge[, 2])
match(1:length(tree[[1]]$tip.label), tree[[1]]$edge[, 2])
match(1:length(tree[[1]]$tip.label), tree[[1]]$edge[, 2]),
,
match((length(tree[[1]]$tip.label) + 1):(length(tree[[1]]$tip.label) + tree[[1]]$Nnode), tree[[1]]$edge[, 2])
(length(tree[[1]]$tip.label) + 1):(length(tree[[1]]$tip.label) + tree[[1]]$Nnode)
match(1:length(tree[[1]]$tip.label), tree[[1]]$edge[, 2]),
,
match((length(tree[[1]]$tip.label) + 1):(length(tree[[1]]$tip.label) + tree[[1]]$Nnode), tree[[1]]$edge[, 1])
match((length(tree[[1]]$tip.label) + 1):(length(tree[[1]]$tip.label) + tree[[1]]$Nnode), tree[[1]]$edge[, 1])
anc
anc <- c(dr, anc)
anc
anc <- anc[c(match(1:length(tree[[1]]$tip.label), tree[[1]]$edge[, 2]),
match((length(tree[[1]]$tip.label) + 1):(length(tree[[1]]$tip.label) + tree[[1]]$Nnode), tree[[1]]$edge[, 1])
)]
anc
tree[[1]]$edge
anc <- phytools::fastAnc(tree[[1]], dr)
anc <- c(dr, anc)
anc
c(match(1:length(tree[[1]]$tip.label), tree[[1]]$edge[, 2]),
match((length(tree[[1]]$tip.label) + 1):(length(tree[[1]]$tip.label) + tree[[1]]$Nnode), tree[[1]]$edge[, 1])
)
tree[[1]]$edge
anc <- phytools::fastAnc(tree[[1]], dr)
anc <- c(dr, anc)
match((length(tree[[1]]$tip.label) + 1):(length(tree[[1]]$tip.label) + (tree[[1]]$Nnode - 1)), tree[[1]]$edge[, 2])
anc <- anc[c(match(1:length(tree[[1]]$tip.label), tree[[1]]$edge[, 2]),
match((length(tree[[1]]$tip.label) + 1):(length(tree[[1]]$tip.label) + (tree[[1]]$Nnode)), tree[[1]]$edge[, 1])
)]
anc
anc <- phytools::fastAnc(tree[[1]], dr)
anc <- c(dr, anc)
anc
plot(tree[[1]])
ape::nodelabels()
anc[c(match(1:length(tree[[1]]$tip.label), tree[[1]]$edge[, 2]),
match((length(tree[[1]]$tip.label) + 2):(length(tree[[1]]$tip.label) + (tree[[1]]$Nnode)), tree[[1]]$edge[, 1])
)]
c(match(1:length(tree[[1]]$tip.label), tree[[1]]$edge[, 2]),
match((length(tree[[1]]$tip.label) + 2):(length(tree[[1]]$tip.label) + (tree[[1]]$Nnode)), tree[[1]]$edge[, 1])
)
anc
tree[[1]]$edge
heat.color(length(anc))
colors <- heat.color(slength(anc))
colors <- heat.colors(length(anc))
colors
colors(order(anc))
colors[order(anc)]
order(anc)
index <- c(match(1:length(tree[[1]]$tip.label), tree[[1]]$edge[, 2]),
match((length(tree[[1]]$tip.label) + 2):(length(tree[[1]]$tip.label) + (tree[[1]]$Nnode)), tree[[1]]$edge[, 1])
)
colors
anc <- phytools::fastAnc(tree[[1]], dr)
anc <- c(dr, anc)
anc
plot(tree[[1]], edge.color = anc)
anc
?phytools::fastAnc
anc <- phytools::fastAnc(tree[[1]], dr)
anc
ape::ace(dr, tree[[1]])
anc <- ape::ace(dr, tree[[1]])
dr
anc
plot(anc)
anc <- phytools::fastAnc(tree[[1]], dr)
anc
values <- c(dr, anc)
which(eq$Species == tree[[1]]$tip.label)
names(values)[1:nrow(eq)] <- 1:nrow(eq)
values
tree[[1]]$edge[, 1] == names(values)
which(tree[[1]]$edge[, 2] == names(values))
names(values)
which(tree[[1]]$edge[, 2] == as.numeric(names(values)))
tree[[1]]$edge[, 2]
names(values)
which(tree[[1]]$edge[, 2] %in% names(values))
match(names(values), tree[[1]]$edge[, 2])
tree[[1]]$edge[, 1]
edge_colors <- character(nrow(tree[[1]]$edge))
edge_colors
tree[[1]]$edge
tree[[1]]$edge[, 2]
values[tree[[1]]$edge[, 2]]
values <- values[tree[[1]]$edge[, 2]]
values
colors <- heat.colors(length(values))
colors
values
ordem <- order(values)
ordem
colors <- colors[order(values)]
colors
names(colors) <- ordem
colors
ordem
plot(tree[[1]], edge.color = colors[names(values)])
colors[names(values)]
values
names(values)
values
colors
ordem
names(values)
colors[names(values)]
names(colors)
ordem
anc <- phytools::fastAnc(tree[[1]], dr)
values <- c(dr, anc)
names(values)[1:nrow(eq)] <- 1:nrow(eq)
values
values <- values[tree[[1]]$edge[, 2]]
values
ordem <- order(values)
colors <- heat.colors(length(values))
ordem
colors <- colors[order(values)]
names(colors) <- ordem
colors
colors[names(values)]
values
ordem
values
ordem
names(ordem) <- names(values)[ordem]
ordem
colors <- colors[order(values)]
values
names(colors) <- names(ordem)
colors
colors[names(values)]
plot(tree[[1]], edge.color = colors[names(values)])
ape::edgelabels()
